async function submitAttendance() {
  const className = document.getElementById("classSelect").value;
  if (!className) return alert("Please select a class.");

  const cards = document.querySelectorAll(".student-card");
  const attendance = [];

  cards.forEach((card, index) => {
    const roll = card.querySelector('input[type="hidden"]').dataset.roll;
    const selectedStatus = card.querySelector(`input[name="status-${index}"]:checked`).value;

    attendance.push({
      roll,
      rowIndex: index,
      status: selectedStatus
    });
  });

  const dateStr = formattedDate.split("/").join("/");

  const url = `${scriptURL}?action=submitAttendance&className=${className}&date=${dateStr}&data=${encodeURIComponent(JSON.stringify(attendance))}`;

  try {
    const res = await fetch(url);
    const result = await res.json();
    if (result.success) {
      alert("✅ Attendance submitted successfully.");
    } else {
      alert("❌ Submission failed: " + result.message);
    }
  } catch (err) {
    console.error("Submit failed", err);
    alert("⚠️ Error submitting attendance.");
  }
}
